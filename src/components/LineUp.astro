---
import IconSlider from "./IconSlider.astro";

// Heart SVG for separators
const HeartSeparator = `
<svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" class="inline-block mx-4 heart-separator">
  <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
</svg>
`;
---

<section id="lineup" class="lineup-section">
    <!-- Top Slider (Left to Right) -->
    <IconSlider direction="right" />

    <!-- Animated Lines Background -->
    <div class="animated-lines">
        <div class="line line-1"></div>
        <div class="line line-2"></div>
        <div class="line line-3"></div>
    </div>

    <!-- Hearts Container for floating animation -->
    <div class="hearts-container"></div>

    <!-- Artist Layout -->
    <div class="container mx-auto px-4 py-20 relative z-10 text-center">
        <!-- Headliners -->
        <div class="flex flex-col items-center gap-2 mb-4">
            <a
                href="#"
                class="artist-name headline hover-artist"
                data-artist="EL BOGUETO"
            >
                EL BOGUETO
            </a>
            <a
                href="#"
                class="artist-name headline hover-artist"
                data-artist="LITTLE JESUS"
            >
                LITTLE JESUS
            </a>
        </div>

        <!-- Accent Artist -->
        <div class="mb-8">
            <a
                href="#"
                class="artist-name accent-headline hover-artist"
                data-artist="ODISSEO"
            >
                ODISSEO
            </a>
        </div>

        <!-- Paired Artists -->
        <div class="flex flex-col gap-3 items-center justify-center">
            <!-- Row 1 -->
            <div class="artist-row">
                <a href="#" class="artist-name mid hover-artist">CACHIRULA</a>
                <span class="text-white" set:html={HeartSeparator} />
                <a href="#" class="artist-name mid hover-artist">KINKY</a>
            </div>

            <!-- Row 2 -->
            <div class="artist-row">
                <a href="#" class="artist-name mid hover-artist">LOOJAN</a>
                <span class="text-white" set:html={HeartSeparator} />
                <a href="#" class="artist-name mid hover-artist">JAVIER BLAKE</a
                >
            </div>

            <!-- Row 3 -->
            <div class="artist-row">
                <a href="#" class="artist-name mid hover-artist">YEYO</a>
                <span class="text-white" set:html={HeartSeparator} />
                <a href="#" class="artist-name mid hover-artist">DOONY GRAFF</a>
            </div>

            <!-- Row 4 -->
            <div class="artist-row">
                <a href="#" class="artist-name mid hover-artist">ALANIS YUKI</a>
                <span class="text-white" set:html={HeartSeparator} />
                <a href="#" class="artist-name mid hover-artist">PLASTIKBOY</a>
            </div>
        </div>

        <!-- Bottom Artist -->
        <div class="mt-8">
            <a
                href="#"
                class="artist-name mid hover-artist"
                data-artist="DENNA LA PORRI"
            >
                DENNA LA PORRI
            </a>
        </div>

        <!-- CTA Button -->
        <div class="text-center mt-16">
            <a
                href="https://arema.mx/dango-festival"
                target="_blank"
                rel="noopener noreferrer"
                class="cta-button"
            >
                COMPRA TUS BOLETOS
            </a>
        </div>
    </div>

    <!-- Bottom Slider (Right to Left) -->
    <IconSlider direction="left" />
</section>

<script>
    import { gsap } from "gsap";
    import { getRandomDangoColor } from "../utils/colorUtils";

    document.addEventListener("astro:page-load", () => {
        // Random color hover for artists
        const artistLinks = document.querySelectorAll(".hover-artist");
        artistLinks.forEach((link) => {
            link.addEventListener("mouseenter", () => {
                (link as HTMLElement).style.color = getRandomDangoColor();
            });

            link.addEventListener("mouseleave", () => {
                // Keep Odisseo accent color if not hovered, otherwise white
                if (link.classList.contains("accent-headline")) {
                    (link as HTMLElement).style.color =
                        "var(--color-dango-orange)";
                } else {
                    (link as HTMLElement).style.color = "";
                }
            });
        });

        // Animated lines
        const lines = document.querySelectorAll(".line");
        lines.forEach((line, i) => {
            gsap.to(line, {
                opacity: 0.3 + i * 0.2,
                duration: 2 + i * 0.5,
                repeat: -1,
                yoyo: true,
                ease: "power1.inOut",
            });
        });

        // Hearts animation on artist hover
        const heartsContainer = document.querySelector(".hearts-container");
        artistLinks.forEach((link) => {
            link.addEventListener("mouseenter", (e) => {
                createHeart(e as MouseEvent, heartsContainer as HTMLElement);
            });
        });
    });

    function createHeart(e: MouseEvent, container: HTMLElement) {
        const heart = document.createElement("div");
        heart.classList.add("heart");
        heart.textContent = "â™¥";
        heart.style.left = `${e.clientX}px`;
        heart.style.top = `${e.clientY}px`;
        heart.style.color = getRandomDangoColor();
        container.appendChild(heart);

        gsap.to(heart, {
            y: -100,
            opacity: 0,
            duration: 1.5,
            ease: "power2.out",
            onComplete: () => heart.remove(),
        });
    }
</script>

<style>
    .lineup-section {
        min-height: 100vh;
        background: #000;
        position: relative;
        overflow: hidden;
        display: flex;
        flex-direction: column;
        justify-content: center;
    }

    .animated-lines {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 1;
    }

    .line {
        position: absolute;
        width: 100%;
        height: 3px;
        background: linear-gradient(
            90deg,
            var(--color-dango-pink),
            var(--color-dango-orange),
            var(--color-dango-yellow),
            var(--color-dango-cyan)
        );
        opacity: 0.2;
    }

    .line-1 {
        top: 20%;
    }
    .line-2 {
        top: 50%;
    }
    .line-3 {
        top: 80%;
    }

    .hearts-container {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 100;
    }

    .heart {
        position: absolute;
        font-size: 2rem;
        pointer-events: none;
    }

    .artist-name {
        display: inline-block;
        font-family: var(--font-kismis);
        font-weight: bold;
        color: #fff;
        text-transform: uppercase;
        transition: all 0.3s ease;
        letter-spacing: 0.05em;
        cursor: pointer;
        line-height: 1;
    }

    .headline {
        font-size: 4rem; /* 64px */
    }

    .accent-headline {
        font-size: 5rem; /* 80px */
        color: var(--color-dango-orange);
    }

    .mid {
        font-size: 2.25rem; /* 36px */
    }

    .artist-row {
        display: flex;
        align-items: center;
        justify-content: center;
        flex-wrap: wrap;
        gap: 0.5rem;
    }

    .artist-name:hover {
        transform: scale(1.1);
    }

    /* Heart separator animation */
    .heart-separator {
        animation: pulse 2s infinite ease-in-out;
    }

    @keyframes pulse {
        0% {
            transform: scale(1);
        }
        50% {
            transform: scale(1.2);
        }
        100% {
            transform: scale(1);
        }
    }

    .cta-button {
        display: inline-block;
        padding: 1rem 3rem;
        background: linear-gradient(
            135deg,
            var(--color-dango-pink),
            var(--color-dango-purple)
        );
        color: white;
        font-family: var(--font-kismis);
        font-size: 1.25rem;
        font-weight: bold;
        text-transform: uppercase;
        border-radius: 50px;
        transition: all 0.3s ease;
        letter-spacing: 0.1em;
    }

    .cta-button:hover {
        transform: scale(1.05);
        box-shadow: 0 10px 40px rgba(255, 20, 147, 0.5);
    }

    @media (max-width: 768px) {
        .headline {
            font-size: 2.5rem;
        }
        .accent-headline {
            font-size: 3rem;
        }
        .mid {
            font-size: 1.5rem;
        }
        .artist-row {
            gap: 0.25rem;
        }
    }
</style>
