---

---

<section id="galeria" class="gallery-section">
    <!-- Fixed Title Banner -->
    <div class="fixed-title z-30">
        <h2 class="banner-text">GALER√çA</h2>
    </div>

    <!-- Horizontal Track -->
    <div class="gallery-track flex flex-nowrap h-full">
        <!-- Block 1: 6 Images (1 row, 6 cols) -->
        <div class="gallery-block grid grid-cols-6">
            {
                Array.from({ length: 6 }).map((_, i) => (
                    <div class="news-item">
                        <div class="placeholder-img" />
                    </div>
                ))
            }
        </div>

        <!-- Block 2: 5 Images (1 row, 5 cols) -->
        <div class="gallery-block grid grid-cols-5">
            {
                Array.from({ length: 5 }).map((_, i) => (
                    <div class="news-item">
                        <div class="placeholder-img" />
                    </div>
                ))
            }
        </div>

        <!-- Block 3: 4 Images (1 row, 4 cols) -->
        <div class="gallery-block grid grid-cols-4">
            {
                Array.from({ length: 4 }).map((_, i) => (
                    <div class="news-item">
                        <div class="placeholder-img" />
                    </div>
                ))
            }
        </div>

        <!-- Block 4: 3 + 3 Images (2 rows, 3 cols) -->
        <div class="gallery-block grid grid-cols-3 grid-rows-2">
            {
                Array.from({ length: 6 }).map((_, i) => (
                    <div class="news-item">
                        <div class="placeholder-img" />
                    </div>
                ))
            }
        </div>

        <!-- Block 5: 2 + 2 + 2 Images (3 rows, 2 cols) -->
        <div class="gallery-block grid grid-cols-2 grid-rows-3">
            {
                Array.from({ length: 6 }).map((_, i) => (
                    <div class="news-item">
                        <div class="placeholder-img" />
                    </div>
                ))
            }
        </div>
    </div>
</section>

<script>
    import { gsap } from "gsap";
    import { ScrollTrigger } from "gsap/ScrollTrigger";

    gsap.registerPlugin(ScrollTrigger);

    document.addEventListener("astro:page-load", () => {
        const section = document.querySelector(".gallery-section");
        const track = section?.querySelector(".gallery-track");

        if (!section || !track) return;

        // Clean up internal items just in case (though scoped)
        // Horizontal Scroll
        // We want to pin the section and scroll the track to the left
        // Total scroll distance = (track.width - viewport.width)

        // We need to calculate this dynamically or force blocks to be 100vw
        // Force blocks to 100vw ensures predictable math:
        // 5 blocks = 500vw. We scroll 400vw.

        const getScrollAmount = () => {
            return -(track.scrollWidth - window.innerWidth);
        };

        const tweet = gsap.to(track, {
            x: getScrollAmount,
            ease: "none",
            scrollTrigger: {
                trigger: section,
                start: "top top",
                end: () => `+=${getScrollAmount() * -1}`, // Scroll distance equals horizontal width
                pin: true,
                scrub: 1,
                invalidateOnRefresh: true,
            },
        });
    });
</script>

<style>
    .gallery-section {
        height: 100vh;
        width: 100%;
        background-color: #000;
        overflow: hidden; /* Hide overflow for the pin */
        position: relative;
    }

    .fixed-title {
        position: absolute;
        top: 2rem;
        left: 0;
        background-color: var(--color-dango-purple, #4b0082);
        padding: 0.5rem 2rem;
        border-radius: 0 4px 4px 0;
    }

    .banner-text {
        font-family: var(
            --font-outfit,
            sans-serif
        ); /* Or Kismis if appropriate, usually clean font for banner */
        color: white;
        font-weight: bold;
        text-transform: uppercase;
        font-size: 1.25rem;
        margin: 0;
    }

    .gallery-track {
        width: fit-content;
        height: 100vh;
    }

    .gallery-block {
        width: 100vw; /* Each block takes full viewport width */
        height: 100vh;
        border-right: 1px solid #111; /* Subtle separator */
    }

    .news-item {
        position: relative;
        overflow: hidden;
        border: 1px solid #000; /* Grid separation */
    }

    .placeholder-img {
        width: 100%;
        height: 100%;
        background-color: #222;
        background-image: url('data:image/svg+xml,%3Csvg width="40" height="40" viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg"%3E%3Cg fill="%23333" fill-rule="evenodd"%3E%3Cpath d="M0 40L40 0H20L0 20M40 40V20L20 40"/%3E%3C/g%3E%3C/svg%3E');
        transition: transform 0.3s ease;
    }

    .news-item:hover .placeholder-img {
        transform: scale(1.05);
    }
</style>
